AmCharts.translations["export"]||(AmCharts.translations["export"]={});
AmCharts.translations["export"].en||(AmCharts.translations["export"].en={"fallback.save.text":"CTRL + C to copy the data into the clipboard.","fallback.save.image":"Rightclick -> Save picture as... to save the image.","capturing.delayed.menu.label":"{{duration}}","capturing.delayed.menu.title":"Click to cancel","menu.label.print":"Print","menu.label.undo":"Undo","menu.label.redo":"Redo","menu.label.cancel":"Cancel","menu.label.save.image":"Download as ...","menu.label.save.data":"Save as ...","menu.label.draw":"Annotate ...",
"menu.label.draw.change":"Change ...","menu.label.draw.add":"Add ...","menu.label.draw.shapes":"Shape ...","menu.label.draw.colors":"Color ...","menu.label.draw.widths":"Size ...","menu.label.draw.opacities":"Opacity ...","menu.label.draw.text":"Text","menu.label.draw.modes":"Mode ...","menu.label.draw.modes.pencil":"Pencil","menu.label.draw.modes.line":"Line","menu.label.draw.modes.arrow":"Arrow"});
(function(){AmCharts["export"]=function(v,w){var a={name:"export",version:"1.4.18",libs:{async:!0,autoLoad:!0,reload:!1,resources:[{"pdfmake/pdfmake.js":["pdfmake/vfs_fonts.js"],"jszip/jszip.js":["xlsx/xlsx.js"]},"fabric.js/fabric.js","FileSaver.js/FileSaver.js"],namespaces:{"pdfmake.js":"pdfMake","jszip.js":"JSZip","xlsx.js":"XLSX","fabric.js":"fabric","FileSaver.js":"saveAs"}},config:{},setup:{chart:v,hasBlob:!1,wrapper:!1},drawing:{enabled:!1,undos:[],redos:[],buffer:{position:{x1:0,y1:0,x2:0,
y2:0,xD:0,yD:0}},handler:{undo:function(b,d){var c=a.drawing.undos.pop();if(c){c.selectable=!0;a.drawing.redos.push(c);"added"==c.action&&a.setup.fabric.remove(c.target);var e=JSON.parse(c.state);c.target.set(e);c.target instanceof fabric.Group&&a.drawing.handler.change({color:e.cfg.color,width:e.cfg.width,opacity:e.cfg.opacity},!0,c.target);a.setup.fabric.renderAll();c.state!=c.target.recentState||d||a.drawing.handler.undo(c,!0)}},redo:function(b,d){var c=a.drawing.redos.pop();if(c){c.selectable=
!0;a.drawing.undos.push(c);"added"==c.action&&a.setup.fabric.add(c.target);var e=JSON.parse(c.state);c.target.recentState=c.state;c.target.set(e);c.target instanceof fabric.Group&&a.drawing.handler.change({color:e.cfg.color,width:e.cfg.width,opacity:e.cfg.opacity},!0,c.target);a.setup.fabric.renderAll();"addified"==c.action&&a.drawing.handler.redo()}},done:function(b){a.drawing.buffer.enabled=!1;a.drawing.undos=[];a.drawing.redos=[];a.createMenu(a.config.menu);a.setup.fabric.deactivateAll();a.setup.wrapper&&
(a.setup.chart.containerDiv.removeChild(a.setup.wrapper),a.setup.wrapper=!1)},add:function(b){var d=a.deepMerge({top:a.setup.fabric.height/2,left:a.setup.fabric.width/2},b||{});(-1!=d.url.indexOf(".svg")?fabric.loadSVGFromURL:fabric.Image.fromURL)(d.url,function(b,e){var f=void 0!==e?fabric.util.groupSVGElements(b,e):b,k=!1;if(f.height>a.setup.fabric.height||f.width>a.setup.fabric.width)k=a.setup.fabric.height/2/f.height;d.top>a.setup.fabric.height&&(d.top=a.setup.fabric.height/2);d.left>a.setup.fabric.width&&
(d.left=a.setup.fabric.width/2);f.set({originX:"center",originY:"center",top:d.top,left:d.left,width:k?f.width*k:f.width,height:k?f.height*k:f.height,fill:a.drawing.color});a.setup.fabric.add(f)})},change:function(b,d,c){b=a.deepMerge({},b||{});var e,f=(c=c||a.drawing.buffer.target)?c._objects?c._objects:[c]:null;b.mode&&(a.drawing.mode=b.mode);b.width&&(a.drawing.width=b.width,a.drawing.fontSize=3*b.width);b.fontSize&&(a.drawing.fontSize=b.fontSize);b.color&&(a.drawing.color=b.color);b.opacity&&
(a.drawing.opacity=b.opacity);e=(new fabric.Color(a.drawing.color)).getSource();e.pop();e.push(a.drawing.opacity);a.drawing.color="rgba("+e.join()+")";a.setup.fabric.freeDrawingBrush.color=a.drawing.color;a.setup.fabric.freeDrawingBrush.width=a.drawing.width;if(c){if(e=JSON.parse(c.recentState).cfg)b.color=b.color||e.color,b.width=b.width||e.width,b.opacity=b.opacity||e.opacity,b.fontSize=b.fontSize||3*b.width,e=(new fabric.Color(b.color)).getSource(),e.pop(),e.push(b.opacity),b.color="rgba("+e.join()+
")";for(e=0;e<f.length;e++)if(f[e]instanceof fabric.Text||f[e]instanceof fabric.PathGroup||f[e]instanceof fabric.Triangle)(b.color||b.opacity)&&f[e].set({fill:b.color}),b.fontSize&&f[e].set({fontSize:b.fontSize});else if(f[e]instanceof fabric.Path||f[e]instanceof fabric.Line)c instanceof fabric.Group?(b.color||b.opacity)&&f[e].set({stroke:b.color}):((b.color||b.opacity)&&f[e].set({stroke:b.color}),b.width&&f[e].set({strokeWidth:b.width}));d||(e=JSON.stringify(a.deepMerge(c.saveState().originalState,
{cfg:{color:b.color,width:b.width,opacity:b.opacity}})),c.recentState=e,a.drawing.redos=[],a.drawing.undos.push({action:"modified",target:c,state:e}));a.setup.fabric.renderAll()}},text:function(b){b=a.deepMerge({text:a.i18l("menu.label.draw.text"),top:a.setup.fabric.height/2,left:a.setup.fabric.width/2,fontSize:a.drawing.fontSize,fontFamily:a.setup.chart.fontFamily||"Verdana",fill:a.drawing.color},b||{});b.click=function(){};b=new fabric.IText(b.text,b);a.setup.fabric.add(b);a.setup.fabric.setActiveObject(b);
b.selectAll();b.enterEditing();return b},line:function(b){b=a.deepMerge({x1:a.setup.fabric.width/2-a.setup.fabric.width/10,x2:a.setup.fabric.width/2+a.setup.fabric.width/10,y1:a.setup.fabric.height/2,y2:a.setup.fabric.height/2,angle:90,strokeLineCap:a.drawing.lineCap,arrow:a.drawing.arrow,color:a.drawing.color,width:a.drawing.width,group:[]},b||{});var d,c,e;d=new fabric.Line([b.x1,b.y1,b.x2,b.y2],{stroke:b.color,strokeWidth:b.width,strokeLineCap:b.strokeLineCap});b.group.push(d);b.arrow&&(b.angle=
b.angle?b.angle:a.getAngle(b.x1,b.y1,b.x2,b.y2),"start"==b.arrow?(c=b.y1+b.width/2,e=b.x1+b.width/2):"middle"==b.arrow?(c=b.y2+b.width/2-(b.y2-b.y1)/2,e=b.x2+b.width/2-(b.x2-b.x1)/2):(c=b.y2+b.width/2,e=b.x2+b.width/2),c=new fabric.Triangle({top:c,left:e,fill:b.color,height:7*b.width,width:7*b.width,angle:b.angle,originX:"center",originY:"bottom"}),b.group.push(c));if("config"!=b.action){if(b.arrow)return d=new fabric.Group(b.group),d.set({cfg:b,fill:b.color,action:b.action,selectable:!0,known:"change"==
b.action}),"change"==b.action&&a.setup.fabric.setActiveObject(d),a.setup.fabric.add(d),d;a.setup.fabric.add(d);return d}for(d=0;d<b.group.length;d++)b.group[d].noUndo=!0,a.setup.fabric.add(b.group[d]);return b}}},defaults:{position:"top-right",fileName:"amCharts",action:"download",overflow:!0,path:(v.path||"")+"plugins/export/",formats:{JPG:{mimeType:"image/jpg",extension:"jpg",capture:!0},PNG:{mimeType:"image/png",extension:"png",capture:!0},SVG:{mimeType:"text/xml",extension:"svg",capture:!0},PDF:{mimeType:"application/pdf",
extension:"pdf",capture:!0},CSV:{mimeType:"text/plain",extension:"csv"},JSON:{mimeType:"text/plain",extension:"json"},XLSX:{mimeType:"application/octet-stream",extension:"xlsx"}},fabric:{backgroundColor:"#FFFFFF",removeImages:!0,selection:!1,drawing:{enabled:!0,arrow:"end",lineCap:"butt",mode:"pencil",modes:["pencil","line","arrow"],color:"#000000",colors:["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF"],shapes:"11.svg 14.svg 16.svg 17.svg 20.svg 27.svg".split(" "),width:1,fontSize:11,widths:[1,
5,10,15],opacity:1,opacities:[1,.8,.6,.4,.2],menu:void 0,autoClose:!0},border:{fill:"",fillOpacity:0,stroke:"#000000",strokeWidth:1,strokeOpacity:1}},pdfMake:{pageSize:"A4",pageOrientation:"portrait",images:{},content:["Saved from:",window.location.href,{image:"reference",fit:[523.28,769.89]}]},menu:void 0,divId:null,menuReviver:null,menuWalker:null,fallback:!0,keyListener:!0,fileListener:!0},i18l:function(b,d){return(AmCharts.translations[a.name][d?langugage:a.setup.chart.language?a.setup.chart.language:
"en"]||AmCharts.translations[a.name].en)[b]||b},download:function(b,d,c){if(window.saveAs&&a.setup.hasBlob)a.toBlob({data:b,type:d},function(a){saveAs(a,c)});else if(a.config.fallback&&"text/plain"==d){var e=document.createElement("div");d=document.createElement("div");var f=document.createElement("textarea");d.innerHTML=a.i18l("fallback.save.text");e.appendChild(d);e.appendChild(f);d.setAttribute("class","amcharts-export-fallback-message");e.setAttribute("class","amcharts-export-fallback");a.setup.chart.containerDiv.appendChild(e);
f.setAttribute("readonly","");f.value=b;f.focus();f.select();a.createMenu([{"class":"export-main export-close",label:"Done",click:function(){a.createMenu(a.config.menu);a.setup.chart.containerDiv.removeChild(e)}}])}else if(a.config.fallback&&"image"==d.split("/")[0])e=document.createElement("div"),d=document.createElement("div"),f=a.toImage({data:b}),d.innerHTML=a.i18l("fallback.save.image"),e.appendChild(d),e.appendChild(f),d.setAttribute("class","amcharts-export-fallback-message"),e.setAttribute("class",
"amcharts-export-fallback"),a.setup.chart.containerDiv.appendChild(e),a.createMenu([{"class":"export-main export-close",label:"Done",click:function(){a.createMenu(a.config.menu);a.setup.chart.containerDiv.removeChild(e)}}]);else throw Error("Unable to create file. Ensure saveAs (FileSaver.js) is supported.");return b},loadResource:function(b,d){var c,e,f,k,h;k=-1!=b.indexOf("//")?b:[a.libs.path,b].join("");var n=function(){if(d)for(c=0;c<d.length;c++)a.loadResource(d[c])};-1!=b.indexOf(".js")?(f=
document.createElement("script"),f.setAttribute("type","text/javascript"),f.setAttribute("src",k),a.libs.async&&f.setAttribute("async","")):-1!=b.indexOf(".css")&&(f=document.createElement("link"),f.setAttribute("type","text/css"),f.setAttribute("rel","stylesheet"),f.setAttribute("href",k));for(c=0;c<document.head.childNodes.length;c++)if(h=(k=document.head.childNodes[c])?k.src||k.href:!1,k&&h&&-1!=h.indexOf(b)){a.libs.reload&&document.head.removeChild(k);e=!0;break}for(c in a.libs.namespaces){var l=
a.libs.namespaces[c];h=b.toLowerCase();k=c.toLowerCase();if(-1!=h.indexOf(k)&&void 0!==window[l]){e=!0;break}}if(!e||a.libs.reload)f.addEventListener("load",n),document.head.appendChild(f),a.listenersToRemove||(a.listenersToRemove=[]),a.listenersToRemove.push({node:f,method:n,event:"load"})},loadDependencies:function(){var b,d;if(a.libs.autoLoad)for(b=0;b<a.libs.resources.length;b++)if(a.libs.resources[b]instanceof Object)for(d in a.libs.resources[b])a.loadResource(d,a.libs.resources[b][d]);else a.loadResource(a.libs.resources[b])},
pxToNumber:function(a,d){return!a&&d?void 0:Number(String(a).replace("px",""))||0},numberToPx:function(a){return String(a)+"px"},deepMerge:function(b,d,c){var e,f,k=d instanceof Array?"array":"object";for(e in d)if("array"!=k||!isNaN(e)){f=d[e];if(void 0==b[e]||c)f instanceof Array?b[e]=[]:f instanceof Function?b[e]=function(){}:f instanceof Date?b[e]=new Date:f instanceof Object?b[e]={}:f instanceof Number?b[e]=new Number:f instanceof String&&(b[e]=new String);!(b instanceof Object||b instanceof
Array)||!(f instanceof Object||f instanceof Array)||f instanceof Function||f instanceof Date||a.isElement(f)||"chart"==e?b instanceof Array&&!c?b.push(f):b[e]=f:a.deepMerge(b[e],f,c)}return b},isElement:function(a){return a instanceof Object&&a&&1===a.nodeType},isHashbanged:function(a){a=String(a).replace(/\"/g,"");return"url"==a.slice(0,3)?a.slice(a.indexOf("#")+1,a.length-1):!1},isPressed:function(b){if("mousemove"!=b.type||1!==b.which)a.drawing.buffer.isPressed="touchmove"==b.type||1===b.buttons||
1===b.button||1===b.which?!0:!1;return a.drawing.buffer.isPressed},isTainted:function(a){var d=String(window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));return a&&-1!=a.indexOf("//")&&-1==a.indexOf(d.replace(/.*:/,""))?!0:!1},isSupported:function(){return!a.config.enabled||AmCharts.isIE&&9>=AmCharts.IEversion&&(!Array.prototype.indexOf||!document.head||!1===a.config.fallback)?!1:!0},getAngle:function(a,d,c,e){a=c-a;d=
e-d;return 180*(0==a?0==d?0:0<d?Math.PI/2:3*Math.PI/2:0==d?0<a?0:Math.PI:0>a?Math.atan(d/a)+Math.PI:0>d?Math.atan(d/a)+2*Math.PI:Math.atan(d/a))/Math.PI},gatherAttribute:function(b,d,c,e){var f;e=e?e:0;c=c?c:3;return b&&(f=b.getAttribute(d),!f&&e<c)?a.gatherAttribute(b.parentNode,d,c,e+1):f},gatherClassName:function(b,d,c,e){var f;e=e?e:0;c=c?c:3;if(a.isElement(b)){f=-1!=(b.getAttribute("class")||"").split(" ").indexOf(d);if(!f&&e<c)return a.gatherClassName(b.parentNode,d,c,e+1);f&&(f=b)}return f},
gatherElements:function(b,d,c){var e,f;for(e=0;e<b.children.length;e++){var k=b.children[e];if("clipPath"==k.tagName){var h={},n=fabric.parseTransformAttribute(a.gatherAttribute(k,"transform"));for(f=0;f<k.childNodes.length;f++)k.childNodes[f].setAttribute("fill","transparent"),h={x:a.pxToNumber(k.childNodes[f].getAttribute("x")),y:a.pxToNumber(k.childNodes[f].getAttribute("y")),width:a.pxToNumber(k.childNodes[f].getAttribute("width")),height:a.pxToNumber(k.childNodes[f].getAttribute("height"))};
b.clippings[k.id]={svg:k,bbox:h,transform:n}}else if("pattern"==k.tagName){h={node:k,source:k.getAttribute("xlink:href"),width:Number(k.getAttribute("width")),height:Number(k.getAttribute("height")),repeat:"repeat"};for(f=0;f<k.childNodes.length;f++)"rect"==k.childNodes[f].tagName&&(h.fill=k.childNodes[f].getAttribute("fill"));d.removeImages&&a.isTainted(h.source)?b.patterns[k.id]=h.fill?h.fill:"transparent":(c.included++,b.patterns[h.node.id]=h)}else"image"==k.tagName&&(c.included++,fabric.Image.fromURL(k.getAttribute("xlink:href"),
function(a){c.loaded++}))}return b},gatherPosition:function(b,d){var c=a.drawing.buffer.position,e=fabric.util.invertTransform(a.setup.fabric.viewportTransform);"touchmove"==b.type&&("touches"in b?b=b.touches[0]:"changedTouches"in b&&(b=b.changedTouches[0]));e=fabric.util.transformPoint(a.setup.fabric.getPointer(b,!0),e);1==d&&(c.x1=e.x,c.y1=e.y);c.x2=e.x;c.y2=e.y;c.xD=0>c.x1-c.x2?-1*(c.x1-c.x2):c.x1-c.x2;c.yD=0>c.y1-c.y2?-1*(c.y1-c.y2):c.y1-c.y2;return c},capture:function(b,d){var c,e=a.deepMerge(a.deepMerge({},
a.config.fabric),b||{}),f=[],k=0,h=0,n=0,l=a.setup.chart.divRealWidth,m=a.setup.chart.divRealHeight,r={loaded:0,included:0};fabric.ElementsParser.prototype.resolveGradient=function(a,b){var c=a.get(b);/^url\(/.test(c)&&(c=c.slice(c.indexOf("#")+1,c.length-1),fabric.gradientDefs[this.svgUid][c]&&a.set(b,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][c],a)))};a.handleCallback(e.beforeCapture,e);var q=a.setup.chart.containerDiv.getElementsByTagName("svg");for(c=0;c<q.length;c++){var g=
{svg:q[c],parent:q[c].parentNode,children:q[c].getElementsByTagName("*"),offset:{x:0,y:0},patterns:{},clippings:{}},g=a.gatherElements(g,e,r);f.push(g)}a.config.legend&&a.setup.chart.legend&&"outside"==a.setup.chart.legend.position&&(g={svg:a.setup.chart.legend.container.container,parent:a.setup.chart.legend.container.container.parentNode,children:a.setup.chart.legend.container.container.getElementsByTagName("*"),offset:{x:0,y:0},legend:{type:-1!=["top","left"].indexOf(a.config.legend.position)?"unshift":
"push",position:a.config.legend.position,width:a.config.legend.width?a.config.legend.width:a.setup.chart.legend.container.width,height:a.config.legend.height?a.config.legend.height:a.setup.chart.legend.container.height},patterns:{},clippings:{}},-1!=["left","right"].indexOf(g.legend.position)?(l+=g.legend.width,m=g.legend.height>m?g.legend.height:m):-1!=["top","bottom"].indexOf(g.legend.position)&&(m+=g.legend.height),g=a.gatherElements(g,e,r),f[g.legend.type](g));a.drawing.buffer.enabled="draw"==
e.action;a.setup.wrapper=document.createElement("div");a.setup.wrapper.setAttribute("class",a.setup.chart.classNamePrefix+"-export-canvas");a.setup.chart.containerDiv.appendChild(a.setup.wrapper);"stock"==a.setup.chart.type&&(g={top:0,right:0,bottom:0,left:0},a.setup.chart.leftContainer&&(l-=a.setup.chart.leftContainer.offsetWidth,g.left=a.setup.chart.leftContainer.offsetWidth+2*a.setup.chart.panelsSettings.panelSpacing),a.setup.chart.rightContainer&&(l-=a.setup.chart.rightContainer.offsetWidth,g.right=
a.setup.chart.rightContainer.offsetWidth+2*a.setup.chart.panelsSettings.panelSpacing),a.setup.chart.periodSelector&&-1!=["top","bottom"].indexOf(a.setup.chart.periodSelector.position)&&(m-=a.setup.chart.periodSelector.offsetHeight+a.setup.chart.panelsSettings.panelSpacing,g[a.setup.chart.periodSelector.position]+=a.setup.chart.periodSelector.offsetHeight+a.setup.chart.panelsSettings.panelSpacing),a.setup.chart.dataSetSelector&&-1!=["top","bottom"].indexOf(a.setup.chart.dataSetSelector.position)&&
(m-=a.setup.chart.dataSetSelector.offsetHeight,g[a.setup.chart.dataSetSelector.position]+=a.setup.chart.dataSetSelector.offsetHeight),a.setup.wrapper.style.paddingTop=a.numberToPx(g.top),a.setup.wrapper.style.paddingRight=a.numberToPx(g.right),a.setup.wrapper.style.paddingBottom=a.numberToPx(g.bottom),a.setup.wrapper.style.paddingLeft=a.numberToPx(g.left));a.setup.canvas=document.createElement("canvas");a.setup.wrapper.appendChild(a.setup.canvas);a.setup.fabric=new fabric.Canvas(a.setup.canvas,a.deepMerge({width:l,
height:m,isDrawingMode:!0},e));a.deepMerge(a.setup.fabric,e);a.deepMerge(a.setup.fabric.freeDrawingBrush,e.drawing);a.deepMerge(a.drawing,e.drawing);a.drawing.handler.change(e.drawing);a.setup.fabric.on("mouse:down",function(c){a.gatherPosition(c.e,1);a.drawing.buffer.pressedTS=Number(new Date);a.isPressed(c.e)});a.setup.fabric.on("mouse:move",function(b){var d=a.gatherPosition(b.e,2);a.isPressed(b.e);a.drawing.buffer.isPressed&&!a.drawing.buffer.line&&!a.drawing.buffer.isSelected&&"pencil"!=a.drawing.mode&&
(5<d.xD||5<d.xD)&&(a.drawing.buffer.hasLine=!0,a.setup.fabric.isDrawingMode=!1,a.setup.fabric._onMouseUpInDrawingMode(b),a.drawing.buffer.line=a.drawing.handler.line({x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,arrow:"line"==a.drawing.mode?!1:a.drawing.arrow,action:"config"}));if(a.drawing.buffer.line){var e,f;b=a.drawing.buffer.line;b.x2=d.x2;b.y2=d.y2;for(c=0;c<b.group.length;c++)d=b.group[c],d instanceof fabric.Line?d.set({x2:b.x2,y2:b.y2}):d instanceof fabric.Triangle&&(b.angle=a.getAngle(b.x1,b.y1,b.x2,
b.y2)+90,"start"==b.arrow?(e=b.y1+b.width/2,f=b.x1+b.width/2):"middle"==b.arrow?(e=b.y2+b.width/2-(b.y2-b.y1)/2,f=b.x2+b.width/2-(b.x2-b.x1)/2):(e=b.y2+b.width/2,f=b.x2+b.width/2),d.set({top:e,left:f,angle:b.angle}));a.setup.fabric.renderAll()}});a.setup.fabric.on("mouse:up",function(b){200>Number(new Date)-a.drawing.buffer.pressedTS&&(b=a.setup.fabric.findTarget(b.e))&&b.selectable&&a.setup.fabric.setActiveObject(b);if(a.drawing.buffer.line){for(c=0;c<a.drawing.buffer.line.group.length;c++)a.drawing.buffer.line.group[c].remove();
delete a.drawing.buffer.line.action;delete a.drawing.buffer.line.group;a.drawing.handler.line(a.drawing.buffer.line)}a.drawing.buffer.line=!1;a.drawing.buffer.hasLine=!1;a.drawing.buffer.isPressed=!1});a.setup.fabric.on("object:selected",function(b){a.drawing.buffer.isSelected=!0;a.drawing.buffer.target=b.target;a.setup.fabric.isDrawingMode=!1});a.setup.fabric.on("selection:cleared",function(b){a.drawing.buffer.onMouseDown=a.setup.fabric.freeDrawingBrush.onMouseDown;a.drawing.buffer.target=!1;a.drawing.buffer.isSelected&&
(a.setup.fabric._isCurrentlyDrawing=!1,a.setup.fabric.freeDrawingBrush.onMouseDown=function(){});setTimeout(function(){a.drawing.buffer.isSelected=!1;a.setup.fabric.isDrawingMode=!0;a.setup.fabric.freeDrawingBrush.onMouseDown=a.drawing.buffer.onMouseDown},10)});a.setup.fabric.on("path:created",function(b){b=b.path;if(200>Number(new Date)-a.drawing.buffer.pressedTS||a.drawing.buffer.hasLine)a.setup.fabric.remove(b),a.setup.fabric.renderAll()});a.setup.fabric.on("object:added",function(b){b=b.target;
var c=a.deepMerge(b.saveState().originalState,{cfg:{color:a.drawing.color,width:a.drawing.width,opacity:a.drawing.opacity,fontSize:a.drawing.fontSize}});200>Number(new Date)-a.drawing.buffer.pressedTS&&!b.noUndo?(a.setup.fabric.remove(b),a.setup.fabric.renderAll()):(c=JSON.stringify(c),b.recentState=c,!b.selectable||b.known||b.noUndo||(a.drawing.undos.push({action:"added",target:b,state:c}),a.drawing.undos.push({action:"addified",target:b,state:c}),a.drawing.redos=[]),b.known=!0,a.setup.fabric.isDrawingMode=
!0)});a.setup.fabric.on("object:modified",function(b){b=b.target;var c=JSON.parse(b.recentState),c=a.deepMerge(b.saveState().originalState,{cfg:c.cfg}),c=JSON.stringify(c);b.recentState=c;a.drawing.undos.push({action:"modified",target:b,state:c});a.drawing.redos=[]});a.setup.fabric.on("text:changed",function(b){var c=b.target;clearTimeout(c.timer);c.timer=setTimeout(function(){var b=JSON.stringify(c.saveState().originalState);c.recentState=b;a.drawing.redos=[];a.drawing.undos.push({action:"modified",
target:c,state:b})},250)});a.drawing.buffer.enabled?(a.setup.wrapper.setAttribute("class",a.setup.chart.classNamePrefix+"-export-canvas active"),a.setup.wrapper.style.backgroundColor=e.backgroundColor,a.setup.wrapper.style.display="block"):(a.setup.wrapper.setAttribute("class",a.setup.chart.classNamePrefix+"-export-canvas"),a.setup.wrapper.style.display="none");for(c=0;c<f.length;c++){var g=f[c],q=a.gatherClassName(g.parent,a.setup.chart.classNamePrefix+"-legend-div",1),p=a.gatherClassName(g.parent,
a.setup.chart.classNamePrefix+"-stock-panel-div"),t=a.gatherClassName(g.parent,a.setup.chart.classNamePrefix+"-scrollbar-chart-div");"stock"==a.setup.chart.type&&a.setup.chart.legendSettings.position?-1!=["top","bottom"].indexOf(a.setup.chart.legendSettings.position)?g.parent.style.top&&g.parent.style.left?(g.offset.y=a.pxToNumber(g.parent.style.top),g.offset.x=a.pxToNumber(g.parent.style.left)):(g.offset.x=k,g.offset.y=h,h+=a.pxToNumber(g.parent.style.height),p?(n=a.pxToNumber(p.style.marginTop),
g.offset.y+=n):t&&(g.offset.y+=n)):-1!=["left","right"].indexOf(a.setup.chart.legendSettings.position)&&(g.offset.y=a.pxToNumber(g.parent.style.top)+n,g.offset.x=a.pxToNumber(g.parent.style.left)+0,q?n+=a.pxToNumber(p.style.height)+a.setup.chart.panelsSettings.panelSpacing:t&&(g.offset.y-=a.setup.chart.panelsSettings.panelSpacing)):("absolute"==g.parent.style.position?(g.offset.absolute=!0,g.offset.top=a.pxToNumber(g.parent.style.top),g.offset.right=a.pxToNumber(g.parent.style.right,!0),g.offset.bottom=
a.pxToNumber(g.parent.style.bottom,!0),g.offset.left=a.pxToNumber(g.parent.style.left),g.offset.width=a.pxToNumber(g.parent.style.width),g.offset.height=a.pxToNumber(g.parent.style.height)):g.parent.style.top&&g.parent.style.left?(g.offset.y=a.pxToNumber(g.parent.style.top),g.offset.x=a.pxToNumber(g.parent.style.left)):g.legend?"left"==g.legend.position?k+=g.legend.width:"right"==g.legend.position?g.offset.x+=l-g.legend.width:"top"==g.legend.position?h+=g.legend.height:"bottom"==g.legend.position&&
(g.offset.y+=m-g.legend.height):(g.offset.x=k,g.offset.y=h+n,h+=a.pxToNumber(g.parent.style.height)),q&&p&&p.style.marginTop?(h+=a.pxToNumber(p.style.marginTop),g.offset.y+=a.pxToNumber(p.style.marginTop)):a.setup.chart.legend&&-1!=["left","right"].indexOf(a.setup.chart.legend.position)&&(g.offset.y=a.pxToNumber(g.parent.style.top),g.offset.x=a.pxToNumber(g.parent.style.left)));fabric.parseSVGDocument(g.svg,function(b){return function(c,k){var g,h=fabric.util.groupSVGElements(c,k),n=[],q={selectable:!1};
b.offset.absolute?(q.top=void 0!==b.offset.bottom?m-b.offset.height-b.offset.bottom:b.offset.top,q.left=void 0!==b.offset.right?l-b.offset.width-b.offset.right:b.offset.left):(q.top=b.offset.y,q.left=b.offset.x);for(g=0;g<h.paths.length;g++){var p=null;if(h.paths[g]){if(e.removeImages&&a.isTainted(h.paths[g]["xlink:href"]))continue;if(h.paths[g].fill instanceof Object){if("radial"==h.paths[g].fill.type)if("pie"==a.setup.chart.type){var t=h.paths[g];t.getCenterPoint();var v=t.group.getCenterPoint(),
w=t.pathOffset.y-v.y;h.paths[g].fill.gradientTransform[4]=t.pathOffset.x-(t.pathOffset.x-v.x);h.paths[g].fill.gradientTransform[5]=t.pathOffset.y-w}else h.paths[g].fill.coords.r2=-1*h.paths[g].fill.coords.r1,h.paths[g].fill.coords.r1=0,h.paths[g].set({opacity:h.paths[g].fillOpacity})}else(p=a.isHashbanged(h.paths[g].fill))&&b.patterns&&b.patterns[p]&&(t=b.patterns[p],fabric.Image.fromURL(t.source,function(a,b){return function(c){r.loaded++;var d=null,e=new fabric.StaticCanvas(void 0,{backgroundColor:a.fill});
e.add(c);d=new fabric.Pattern({source:function(){e.setDimensions({width:a.width,height:a.height});return e.getElement()},repeat:"repeat"});h.paths[b].set({fill:d,opacity:h.paths[b].fillOpacity})}}(t,g)));(p=a.isHashbanged(h.paths[g].clipPath))&&b.clippings&&b.clippings[p]&&(function(a,c){var d=h.paths[a].toSVG;h.paths[a].toSVG=function(a){return d.apply(this,[function(d){return a(d,b.clippings[c])}])}}(g,p),h.paths[g].set({clipTo:function(c,d){return function(c){var e=b.clippings[d],f=this.transformMatrix||
[1,0,0,1,0,0],g=e.bbox.y,k=e.bbox.x,h=e.bbox.width,l=e.bbox.height;"map"==a.setup.chart.type&&(g+=e.transform[5],k+=e.transform[4]);e.bbox.x&&f[4]&&e.bbox.y&&f[5]&&(g-=f[5],k-=f[4]);c.rect(k,g,h,l)}}(g,p)}));if(h.paths[g].TSPANWORKAROUND){p=fabric.parseAttributes(h.paths[g].svg,fabric.Text.ATTRIBUTE_NAMES);k=fabric.util.object.extend({},p);p=[];for(t=0;t<h.paths[g].svg.childNodes.length;t++)v=fabric.Text.fromElement(h.paths[g].svg.childNodes[t],k),v.set({left:0}),p.push(v);h.paths[g].set({opacity:0});
p=new fabric.Group(p,{top:-1*h.paths[g].top});h.paths[g]=p}}n.push(h.paths[g])}h.paths=n;h.set(q);a.setup.fabric.add(h);if(b.svg.parentNode&&b.svg.parentNode.getElementsByTagName)for(n=b.svg.parentNode.getElementsByClassName(a.setup.chart.classNamePrefix+"-balloon-div"),g=0;g<n.length;g++)e.balloonFunction instanceof Function?e.balloonFunction.apply(a,[n[g],b]):(q=n[g],p=fabric.parseStyleAttribute(q),t=fabric.parseStyleAttribute(q.childNodes[0]),q=new fabric.Text(q.innerText||q.textContent||q.innerHTML,
{selectable:!1,top:p.top+b.offset.y,left:p.left+b.offset.x,fill:t.color,fontSize:t.fontSize,fontFamily:t.fontFamily,textAlign:t["text-align"]}),a.setup.fabric.add(q));b.svg.nextSibling&&"A"==b.svg.nextSibling.tagName&&(q=b.svg.nextSibling,p=fabric.parseStyleAttribute(q),q=new fabric.Text(q.innerText||q.textContent||q.innerHTML,{selectable:!1,top:p.top+b.offset.y,left:p.left+b.offset.x,fill:p.color,fontSize:p.fontSize,fontFamily:p.fontFamily,opacity:p.opacity}),a.setup.fabric.add(q));f.pop();if(!f.length)var y=
setInterval(function(){r.loaded==r.included&&(clearTimeout(y),a.handleBorder(e),a.handleCallback(e.afterCapture,e),a.setup.fabric.renderAll(),a.handleCallback(d,e))},AmCharts.updateRate)}}(g),function(b,c){var d;d=a.gatherAttribute(b,"class");var f=a.gatherAttribute(b,"visibility"),g=a.gatherAttribute(b,"clip-path");c.className=String(d);c.classList=String(d).split(" ");c.clipPath=g;c.svg=b;"text"==b.tagName&&1<b.childNodes.length&&(c.TSPANWORKAROUND=!0);if("hidden"==f)c.opacity=0;else for(f=["fill",
"stroke"],d=0;d<f.length;d++){var g=f[d],k=String(b.getAttribute(g)||""),h=Number(b.getAttribute(g+"-opacity")||"1"),l=fabric.Color.fromHex(k).getSource();-1==c.classList.indexOf(a.setup.chart.classNamePrefix+"-guide-fill")||k||(h=0,l=fabric.Color.fromHex("#000000").getSource());l&&(l.pop(),l.push(h),c[g]="rgba("+l.join()+")",c[g+a.capitalize("opacity")]=h)}a.handleCallback(e.reviver,c,b)})}},toCanvas:function(b,d){a.deepMerge({},b||{});var c=a.setup.canvas;a.handleCallback(d,c);return c},toImage:function(b,
d){var c=a.deepMerge({format:"png",quality:1,multiplier:this.config.multiplier},b||{}),e=c.data,f=document.createElement("img");c.data||(e=c.lossless||"svg"==c.format?a.toSVG(a.deepMerge(c,{getBase64:!0})):a.setup.fabric.toDataURL(c));f.setAttribute("src",e);a.handleCallback(d,f);return f},toBlob:function(b,d){var c=a.deepMerge({data:"empty",type:"text/plain"},b||{}),e=/^data:.+;base64,(.*)$/.exec(c.data);e&&(c.data=e[0],c.type=c.data.slice(5,c.data.indexOf(",")-7),c.data=a.toByteArray({data:c.data.slice(c.data.indexOf(",")+
1,c.data.length)}));c=c.getByteArray?c.data:new Blob([c.data],{type:c.type});a.handleCallback(d,c);return c},toJPG:function(b,d){var c=a.deepMerge({format:"jpeg",quality:1,multiplier:this.config.multiplier},b||{});c.format=c.format.toLowerCase();c=a.setup.fabric.toDataURL(c);a.handleCallback(d,c);return c},toPNG:function(b,d){var c=a.deepMerge({format:"png",quality:1,multiplier:this.config.multiplier},b||{}),c=a.setup.fabric.toDataURL(c);a.handleCallback(d,c);return c},toSVG:function(b,d){var c=[],
e=a.deepMerge({reviver:function(a,b){var d=(new RegExp(/\bstyle=(['"])(.*?)\1/)).exec(a)[0].slice(7,-1),e=d.split(";"),f=[];for(i1=0;i1<e.length;i1++)if(e[i1]){var k=e[i1].replace(/\s/g,"").split(":"),g=k[0],p=k[1];-1!=["fill","stroke"].indexOf(g)?(p=fabric.Color.fromRgba(p))&&p._source?(k="#"+p.toHex(),p=p._source[3],f.push([g,k].join(":")),f.push([g+"-opacity",p].join(":"))):f.push(e[i1]):"opactiy"!=g&&f.push(e[i1])}a=a.replace(d,f.join(";"));b&&(e=2,d=a.slice(-e),"/>"!=d&&(e=3,d=a.slice(-e)),e=
a.slice(0,a.length-e),f=' clip-path="url(#'+b.svg.id+')" ',g=(new XMLSerializer).serializeToString(b.svg),a=e+f+d,c.push(g));return a}},b||{}),f=a.setup.fabric.toSVG(e,e.reviver);if(c.length)var k=f.slice(0,f.length-6),f=f.slice(-6),f=k+c.join("")+f;e.getBase64&&(f="data:image/svg+xml;base64,"+btoa(f));a.handleCallback(d,f);return f},toPDF:function(b,d){var c=a.deepMerge(a.deepMerge({multiplier:2},a.config.pdfMake),b||{},!0);c.images.reference=a.toPNG(c);c=new pdfMake.createPdf(c);d&&c.getDataUrl(function(b){return function(){b.apply(a,
arguments)}}(d));return c},toPRINT:function(b,d){var c,e=a.deepMerge({delay:1,lossless:!1},b||{}),f=a.toImage(e),k=[],h=document.body.childNodes;f.setAttribute("style","width: 100%; max-height: 100%;");for(c=0;c<h.length;c++)a.isElement(h[c])&&(k[c]=h[c].style.display,h[c].style.display="none");document.body.appendChild(f);window.print();setTimeout(function(){for(c=0;c<h.length;c++)a.isElement(h[c])&&(h[c].style.display=k[c]);document.body.removeChild(f);a.handleCallback(d,f)},e.delay);return f},
toJSON:function(b,d){var c=a.deepMerge({dateFormat:a.config.dateFormat||"dateObject"},b||{},!0);c.data=c.data?c.data:a.getChartData(c);c=JSON.stringify(c.data,void 0,"\t");a.handleCallback(d,c);return c},toCSV:function(b,d){function c(a,b){"string"===typeof a&&(k.escape&&(a=a.replace('"','""')),k.quotes&&(a=['"',a,'"'].join("")));return a}var e,f,k=a.deepMerge({data:a.getChartData(b),delimiter:",",quotes:!0,escape:!0,withHeader:!0},b||{},!0),h="",n=[],l=[];for(r in k.data[0])l.push(c(r)),n.push(r);
k.withHeader&&(h+=l.join(k.delimiter)+"\n");for(e in k.data)if(l=[],!isNaN(e)){for(f in n)if(!isNaN(f)){var m=n[f],r=k.data[e][m];l.push(c(r,m))}h+=l.join(k.delimiter)+"\n"}a.handleCallback(d,h);return h},toXLSX:function(b,d){var c=a.deepMerge({name:"amCharts",dateFormat:a.config.dateFormat||"dateObject",withHeader:!0,stringify:!1},b||{},!0),e="",e={SheetNames:[],Sheets:{}};c.data=c.data?c.data:a.getChartData(c);e.SheetNames.push(c.name);for(var f=e.Sheets,k=c.name,c=a.toArray(c),h={},n={s:{c:1E7,
r:1E7},e:{c:0,r:0}},l=0;l!=c.length;++l)for(var m=0;m!=c[l].length;++m){n.s.r>l&&(n.s.r=l);n.s.c>m&&(n.s.c=m);n.e.r<l&&(n.e.r=l);n.e.c<m&&(n.e.c=m);var r={v:c[l][m]};if(null!=r.v){var q=XLSX.utils.encode_cell({c:m,r:l});if("number"===typeof r.v)r.t="n";else if("boolean"===typeof r.v)r.t="b";else if(r.v instanceof Date){r.t="n";r.z=XLSX.SSF._table[14];var g=r,p;p=(Date.parse(r.v)-new Date(Date.UTC(1899,11,30)))/864E5;g.v=p}else r.t="s";h[q]=r}}1E7>n.s.c&&(h["!ref"]=XLSX.utils.encode_range(n));f[k]=
h;e=XLSX.write(e,{bookType:"xlsx",bookSST:!0,type:"base64"});e="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+e;a.handleCallback(d,e);return e},toArray:function(b,d){var c,e,f=a.deepMerge({data:a.getChartData(b),withHeader:!1,stringify:!0},b||{},!0),k=[],h=[];for(e in f.data[0])h.push(e);f.withHeader&&k.push(h);for(c in f.data){var n=[];if(!isNaN(c)){for(e in h)if(!isNaN(e)){e=h[e];var l=f.data[c][e];null==l?l="":f.stringify&&(l=String(l));n.push(l)}k.push(n)}}a.handleCallback(d,
k);return k},toByteArray:function(b,d){function c(a){a=a.charCodeAt(0);if(43===a)return 62;if(47===a)return 63;if(48>a)return-1;if(58>a)return a-48+52;if(91>a)return a-65;if(123>a)return a-97+26}var e=a.deepMerge({},b||{}),f="undefined"!==typeof Uint8Array?Uint8Array:Array,e=function(a){function b(a){q[g++]=a}var d,e,m,r,q;if(0<a.length%4)throw Error("Invalid string. Length must be a multiple of 4");d=a.length;r="="===a.charAt(d-2)?2:"="===a.charAt(d-1)?1:0;q=new f(3*a.length/4-r);e=0<r?a.length-
4:a.length;var g=0;for(d=0;d<e;d+=4)m=c(a.charAt(d))<<18|c(a.charAt(d+1))<<12|c(a.charAt(d+2))<<6|c(a.charAt(d+3)),b((m&16711680)>>16),b((m&65280)>>8),b(m&255);2===r?(m=c(a.charAt(d))<<2|c(a.charAt(d+1))>>4,b(m&255)):1===r&&(m=c(a.charAt(d))<<10|c(a.charAt(d+1))<<4|c(a.charAt(d+2))>>2,b(m>>8&255),b(m&255));return q}(e.data);a.handleCallback(d,e);return e},handleCallback:function(b){var d,c=[];if(b&&b instanceof Function){for(d=0;d<arguments.length;d++)0<d&&c.push(arguments[d]);b.apply(a,c)}},handleBorder:function(b){if(a.config.border instanceof
Object){b=a.deepMerge(a.defaults.fabric.border,b.border||{},!0);var d=new fabric.Rect;b.width=a.setup.fabric.width-b.strokeWidth;b.height=a.setup.fabric.height-b.strokeWidth;d.set(b);a.setup.fabric.add(d)}},handleDropbox:function(b){if(a.drawing.buffer.enabled)if(b.preventDefault(),b.stopPropagation(),"dragover"==b.type)a.setup.wrapper.setAttribute("class",a.setup.chart.classNamePrefix+"-export-canvas active dropbox");else if(a.setup.wrapper.setAttribute("class",a.setup.chart.classNamePrefix+"-export-canvas active"),
"drop"==b.type&&b.dataTransfer.files.length)for(var d=0;d<b.dataTransfer.files.length;d++){var c=new FileReader;c.onloadend=function(d){return function(){a.drawing.handler.add({url:c.result,top:b.layerY-10*d,left:b.layerX-10*d})}}(d);c.readAsDataURL(b.dataTransfer.files[d])}},getChartData:function(b){function d(b,d,f){function h(a,b){return-1!=c.dataFields.indexOf(a)?h([a,".",b].join("")):a}b&&c.exportTitles&&"gantt"!=a.setup.chart.type&&(e=h(b,f),c.dataFieldsMap[e]=b,c.dataFields.push(e),c.titles[e]=
d||e)}var c=a.deepMerge({data:[],titles:{},dateFields:[],dataFields:[],dataFieldsMap:{},exportTitles:a.config.exportTitles,exportFields:a.config.exportFields,exportSelection:a.config.exportSelection,columnNames:a.config.columnNames},b||{},!0),e,f,k,h="valueField openField closeField highField lowField xField yField".split(" ");if(0==c.data.length)if("stock"==a.setup.chart.type){c.data=a.setup.chart.mainDataSet.dataProvider;d(a.setup.chart.mainDataSet.categoryField);c.dateFields.push(a.setup.chart.mainDataSet.categoryField);
for(b=0;b<a.setup.chart.mainDataSet.fieldMappings.length;b++){var n=a.setup.chart.mainDataSet.fieldMappings[b];for(f=0;f<a.setup.chart.panels.length;f++){var l=a.setup.chart.panels[f];for(k=0;k<l.stockGraphs.length;k++){var m=l.stockGraphs[k];for(i4=0;i4<h.length;i4++)m[h[i4]]==n.toField&&d(n.fromField,m.title,h[i4])}}}for(b=0;b<a.setup.chart.comparedGraphs.length;b++)for(m=a.setup.chart.comparedGraphs[b],f=0;f<m.dataSet.dataProvider.length;f++)for(k=0;k<m.dataSet.fieldMappings.length;k++)n=m.dataSet.fieldMappings[k],
e=m.dataSet.id+"_"+n.toField,f<c.data.length&&(c.data[f][e]=m.dataSet.dataProvider[f][n.fromField],c.titles[e]||d(e,m.dataSet.title))}else if("gantt"==a.setup.chart.type){d(a.setup.chart.categoryField);c.dateFields.push(a.setup.chart.categoryField);m=a.setup.chart.segmentsField;for(b=0;b<a.setup.chart.dataProvider.length;b++)if(k=a.setup.chart.dataProvider[b],k[m])for(f=0;f<k[m].length;f++)k[m][f][a.setup.chart.categoryField]=k[a.setup.chart.categoryField],c.data.push(k[m][f]);for(b=0;b<a.setup.chart.graphs.length;b++)for(m=
a.setup.chart.graphs[b],f=0;f<h.length;f++)k=h[f],n=m[k],d(n,m.title,k)}else if(-1!=["pie","funnel"].indexOf(a.setup.chart.type))c.data=a.setup.chart.dataProvider,d(a.setup.chart.titleField),c.dateFields.push(a.setup.chart.titleField),d(a.setup.chart.valueField);else if("map"!=a.setup.chart.type)for(c.data=a.setup.chart.dataProvider,a.setup.chart.categoryAxis&&(d(a.setup.chart.categoryField,a.setup.chart.categoryAxis.title),!1!==a.setup.chart.categoryAxis.parseDates&&c.dateFields.push(a.setup.chart.categoryField)),
b=0;b<a.setup.chart.graphs.length;b++)for(m=a.setup.chart.graphs[b],f=0;f<h.length;f++)k=h[f],n=m[k],d(n,m.title,k);return a.processData(c)},processData:function(b){var d=a.deepMerge({data:[],titles:{},dateFields:[],dataFields:[],dataFieldsMap:{},dataDateFormat:a.setup.chart.dataDateFormat,dateFormat:a.config.dateFormat||a.setup.chart.dataDateFormat||"YYYY-MM-DD",exportTitles:a.config.exportTitles,exportFields:a.config.exportFields,exportSelection:a.config.exportSelection,columnNames:a.config.columnNames,
processData:a.config.processData},b||{},!0),c;if(d.data.length){for(b=0;b<d.data.length;b++)for(c in d.data[b])-1==d.dataFields.indexOf(c)&&(d.dataFields.push(c),d.dataFieldsMap[c]=c);void 0!==d.exportFields&&(d.dataFields=d.dataFields.filter(function(a){return-1!=d.exportFields.indexOf(a)}));var e=[];for(b=0;b<d.data.length;b++){var f={},k=!1;for(c=0;c<d.dataFields.length;c++){var h=d.dataFields[c],n=d.dataFieldsMap[h],l=d.columnNames&&d.columnNames[h]||d.titles[h]||h,m=d.data[b][n];null==m&&(m=
void 0);d.exportTitles&&"gantt"!=a.setup.chart.type&&l in f&&(l+=["( ",h," )"].join(""));if(-1!=d.dateFields.indexOf(n)){d.dataDateFormat&&(m instanceof String||"string"==typeof m)?m=AmCharts.stringToDate(m,d.dataDateFormat):d.dateFormat&&(m instanceof Number||"number"==typeof m)&&(m=new Date(m));if(d.exportSelection)if(m instanceof Date){if(m<v.startDate||m>v.endDate)k=!0}else if(b<v.startIndex||b>v.endIndex)k=!0;d.dateFormat&&"dateObject"!=d.dateFormat&&m instanceof Date&&(m=AmCharts.formatDate(m,
d.dateFormat))}f[l]=m}k||e.push(f)}d.data=e}return void 0!==d.processData?d.processData(d.data):d.data},capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()},createMenu:function(b,d){function c(b,d){var k,h,n=document.createElement("ul");for(k=0;k<b.length;k++){var l="string"===typeof b[k]?{format:b[k]}:b[k],m=document.createElement("li"),r=document.createElement("a"),q=document.createElement("img"),g=document.createElement("span");h=String(l.action?l.action:l.format).toLowerCase();
l.format=String(l.format).toUpperCase();a.config.formats[l.format]?l=a.deepMerge({label:l.icon?"":l.format,format:l.format,mimeType:a.config.formats[l.format].mimeType,extension:a.config.formats[l.format].extension,capture:a.config.formats[l.format].capture,action:a.config.action,fileName:a.config.fileName},l):l.label||(l.label=l.label?l.label:a.i18l("menu.label."+h));if(!(-1!=["CSV","JSON","XLSX"].indexOf(l.format)&&-1!=["map","gauge"].indexOf(a.setup.chart.type)||!a.setup.hasBlob&&"UNDEFINED"!=
l.format&&l.mimeType&&"image"!=l.mimeType.split("/")[0]&&"text/plain"!=l.mimeType)){if("draw"==l.action)a.config.fabric.drawing.enabled?(l.menu=l.menu?l.menu:a.config.fabric.drawing.menu,l.click=function(a){return function(){this.capture(a,function(){this.createMenu(a.menu)})}}(l)):l.menu=[];else if(!l.populated&&l.action&&-1!=l.action.indexOf("draw.")){var p=l.action.split(".")[1],t=l[p]||a.config.fabric.drawing[p]||[];l.menu=[];l.populated=!0;for(h=0;h<t.length;h++){var u={label:t[h]};if("shapes"==
p){var w=-1==t[h].indexOf("//"),x=(w?a.config.path+"shapes/":"")+t[h];u.action="add";u.url=x;u.icon=x;u.ignore=w;u["class"]="export-drawing-shape"}else"colors"==p?(u.style="background-color: "+t[h],u.action="change",u.color=t[h],u["class"]="export-drawing-color"):"widths"==p?(u.action="change",u.width=t[h],u.label=document.createElement("span"),u.label.style.width=a.numberToPx(t[h]),u.label.style.height=a.numberToPx(t[h]),u["class"]="export-drawing-width"):"opacities"==p?(u.style="opacity: "+t[h],
u.action="change",u.opacity=t[h],u.label=100*t[h]+"%",u["class"]="export-drawing-opacity"):"modes"==p&&(u.label=a.i18l("menu.label.draw.modes."+t[h]),u.click=function(b){return function(){a.drawing.mode=b}}(t[h]),u["class"]="export-drawing-mode");l.menu.push(u)}}else l.click||l.menu||l.items||(a.drawing.handler[h]instanceof Function?(l.action=h,l.click=function(a){return function(){this.drawing.handler[a.action](a)}}(l)):a.drawing.buffer.enabled?l.click=function(a){return function(){this.config.drawing.autoClose&&
this.drawing.handler.done();this["to"+a.format](a,function(b){"download"==a.action&&this.download(b,a.mimeType,[a.fileName,a.extension].join("."))})}}(l):"UNDEFINED"!=l.format&&(l.click=function(a){return function(){if(a.capture||"print"==a.action||"PRINT"==a.format)this.capture(a,function(){this.config.drawing.autoClose&&this.drawing.handler.done();this["to"+a.format](a,function(b){"download"==a.action&&this.download(b,a.mimeType,[a.fileName,a.extension].join("."))})});else if(this["to"+a.format])this["to"+
a.format](a,function(b){this.download(b,a.mimeType,[a.fileName,a.extension].join("."))});else throw Error("Invalid format. Could not determine output type.");}}(l)));if(void 0===l.menu||l.menu.length)r.setAttribute("href","#"),r.addEventListener("click",function(b,c){return function(d){d.preventDefault();d=[d,c];if(("draw"==c.action||"PRINT"==c.format||"UNDEFINED"!=c.format&&c.capture)&&!a.drawing.enabled&&(c.delay=c.delay?c.delay:a.config.delay,c.delay)){a.delay(c,b);return}b.apply(a,d)}}(l.click||
function(a){a.preventDefault()},l)),m.appendChild(r),a.isElement(l.label)?g.appendChild(l.label):g.innerHTML=l.label,l["class"]&&(m.className=l["class"]),l.style&&m.setAttribute("style",l.style),l.icon&&(q.setAttribute("src",(l.ignore||-1!=l.icon.slice(0,10).indexOf("//")?"":v.pathToImages)+l.icon),r.appendChild(q)),l.label&&r.appendChild(g),l.title&&r.setAttribute("title",l.title),a.config.menuReviver&&(m=a.config.menuReviver.apply(a,[l,m])),l.elements={li:m,a:r,img:q,span:g},(l.menu||l.items)&&
"draw"!=l.action?c(l.menu||l.items,m).childNodes.length&&n.appendChild(m):n.appendChild(m)}}n.childNodes.length&&d.appendChild(n);return n}d||("string"==typeof a.config.divId?a.config.divId=d=document.getElementById(a.config.divId):d=a.isElement(a.config.divId)?a.config.divId:a.setup.chart.containerDiv);a.isElement(a.setup.menu)?a.setup.menu.innerHTML="":a.setup.menu=document.createElement("div");a.setup.menu.setAttribute("class",a.setup.chart.classNamePrefix+"-export-menu "+a.setup.chart.classNamePrefix+
"-export-menu-"+a.config.position+" amExportButton");a.config.menuWalker&&(c=a.config.menuWalker);c.apply(this,[b,a.setup.menu]);a.setup.menu.childNodes.length&&d.appendChild(a.setup.menu);return a.setup.menu},delay:function(b,d){var c=a.deepMerge({delay:3,precision:2},b||{}),e,f,k=Number(new Date),h=a.createMenu([{label:a.i18l("capturing.delayed.menu.label").replace("{{duration}}",AmCharts.toFixed(c.delay,c.precision)),title:a.i18l("capturing.delayed.menu.title"),"class":"export-delayed-capturing",
click:function(){clearTimeout(e);clearTimeout(f);a.createMenu(a.config.menu)}}]).getElementsByTagName("a")[0];e=setInterval(function(){var b=c.delay-(Number(new Date)-k)/1E3;0>=b?(clearTimeout(e),"draw"!=c.action&&a.createMenu(a.config.menu)):h&&(h.innerHTML=a.i18l("capturing.delayed.menu.label").replace("{{duration}}",AmCharts.toFixed(b,2)))},10);f=setTimeout(function(){d.apply(a,arguments)},1E3*c.delay)},migrateSetup:function(a){function d(a){for(var b in a){var k=a[b];"export"==b.slice(0,6)&&k?
c.menu.push(b.slice(6)):"userCFG"==b?d(k):"menuItems"==b?c.menu=k:"libs"==b?c.libs=k:"string"==typeof b&&(c[b]=k)}}var c={enabled:!0,migrated:!0,libs:{autoLoad:!0},menu:[]};d(a);return c},clear:function(){a.setup=void 0;a.docListener&&document.removeEventListener("keydown",a.docListener);var b=a.listenersToRemove;if(b)for(var d=0;d<b.length;d++){var c=b[d];c.node.removeEventListener(c.event,c.method)}a.listenersToRemove=[]},loadListeners:function(){function b(b){b&&(b.set({top:b.top+10,left:b.left+
10}),a.setup.fabric.add(b))}a.config.keyListener&&"attached"!=a.config.keyListener&&(a.docListener=function(d){var c=a.drawing.buffer.target;8!=d.keyCode&&46!=d.keyCode||!c?27==d.keyCode&&a.drawing.enabled?(d.preventDefault(),a.drawing.handler.done()):67==d.keyCode&&(d.metaKey||d.ctrlKey)&&c?a.drawing.buffer.copy=c:88==d.keyCode&&(d.metaKey||d.ctrlKey)&&c?(a.drawing.buffer.copy=c,a.setup.fabric.remove(c)):86==d.keyCode&&(d.metaKey||d.ctrlKey)?a.drawing.buffer.copy&&b(a.drawing.buffer.copy.clone(b)):
90==d.keyCode&&(d.metaKey||d.ctrlKey)&&(d.preventDefault(),d.shiftKey?a.drawing.handler.redo():a.drawing.handler.undo()):(d.preventDefault(),a.setup.fabric.remove(c))},a.config.keyListener="attached",document.addEventListener("keydown",a.docListener));a.config.fileListener&&(a.setup.chart.containerDiv.addEventListener("dragover",a.handleDropbox),a.setup.chart.containerDiv.addEventListener("dragleave",a.handleDropbox),a.setup.chart.containerDiv.addEventListener("drop",a.handleDropbox))},init:function(){clearTimeout(a.timer);
a.timer=setInterval(function(){a.setup.chart.containerDiv&&(clearTimeout(a.timer),a.config.enabled&&(a.setup.chart.AmExport=a,a.config.overflow&&(a.setup.chart.div.style.overflow="visible"),a.loadListeners(),a.createMenu(a.config.menu)))},AmCharts.updateRate)},construct:function(){a.drawing.handler.cancel=a.drawing.handler.done;try{a.setup.hasBlob=!!new Blob}catch(b){}window.safari=window.safari?window.safari:{};a.defaults.fabric.drawing.fontSize=a.setup.chart.fontSize||11;a.config.drawing=a.deepMerge(a.defaults.fabric.drawing,
a.config.drawing||{},!0);a.config.border&&(a.config.border=a.deepMerge(a.defaults.fabric.border,a.config.border||{},!0));a.deepMerge(a.defaults.fabric,a.config,!0);a.deepMerge(a.defaults.fabric,a.config.fabric||{},!0);a.deepMerge(a.defaults.pdfMake,a.config,!0);a.deepMerge(a.defaults.pdfMake,a.config.pdfMake||{},!0);a.deepMerge(a.libs,a.config.libs||{},!0);a.config.drawing=a.defaults.fabric.drawing;a.config.fabric=a.defaults.fabric;a.config.pdfMake=a.defaults.pdfMake;a.config=a.deepMerge(a.defaults,
a.config,!0);a.config.fabric.drawing.enabled&&void 0===a.config.fabric.drawing.menu&&(a.config.fabric.drawing.menu=[],a.deepMerge(a.config.fabric.drawing.menu,[{"class":"export-drawing",menu:[{label:a.i18l("menu.label.draw.add"),menu:[{label:a.i18l("menu.label.draw.shapes"),action:"draw.shapes"},{label:a.i18l("menu.label.draw.text"),action:"text"}]},{label:a.i18l("menu.label.draw.change"),menu:[{label:a.i18l("menu.label.draw.modes"),action:"draw.modes"},{label:a.i18l("menu.label.draw.colors"),action:"draw.colors"},
{label:a.i18l("menu.label.draw.widths"),action:"draw.widths"},{label:a.i18l("menu.label.draw.opacities"),action:"draw.opacities"},"UNDO","REDO"]},{label:a.i18l("menu.label.save.image"),menu:["PNG","JPG","SVG","PDF"]},"PRINT","CANCEL"]}]));void 0===a.config.menu&&(a.config.menu=[],a.deepMerge(a.config,{menu:[{"class":"export-main",menu:[{label:a.i18l("menu.label.save.image"),menu:["PNG","JPG","SVG","PDF"]},{label:a.i18l("menu.label.save.data"),menu:["CSV","XLSX","JSON"]},{label:a.i18l("menu.label.draw"),
action:"draw",menu:a.config.fabric.drawing.menu},{format:"PRINT",label:a.i18l("menu.label.print")}]}]}));a.libs.path||(a.libs.path=a.config.path+"libs/");a.isSupported()&&(a.loadDependencies(a.libs.resources,a.libs.reload),a.setup.chart.addClassNames=!0,a.setup.chart[a.name]=a,a.init())}};if(w)a.config=w;else if(a.setup.chart[a.name])a.config=a.setup.chart[a.name];else if(a.setup.chart.amExport||a.setup.chart.exportConfig)a.config=a.migrateSetup(a.setup.chart.amExport||a.setup.chart.exportConfig);
else return;a.construct();return a.deepMerge(this,a)}})();AmCharts.addInitHandler(function(v){new AmCharts["export"](v)},"pie serial xy funnel radar gauge stock map gantt".split(" "));